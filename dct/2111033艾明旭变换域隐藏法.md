# # 信息隐藏技术第七次实验 —— `变换域隐藏法`

> **学号：2111033 
> 姓名：艾明旭 
> 专业：信息安全**

## 一、`DCT` 域信息隐藏

---

- 图像压缩标准 `JPEG` 的核心——二维 `DCT` 变换
- 在 `DCT` 域中的信息隐藏，能有效抵抗 `JPEG` 有损压缩

DCT 域的信息隐藏包括：

1. 修改系数方法
2. 系数比较方法

利用其中一种方法事先变换域的信息隐藏和提取。

## 二、隐藏算法

#### 变换域技术

在载体的显著区域隐藏信息，比 LSB 方法能够更好地抵抗攻击，而且保持了对人类感观的不可察觉性。常用的变换域方法：离散余弦变换 DCT，离散小波变换 DWT，离散傅里叶变换

DFT。

图像压缩标准（JPEG）的核心：二维 DCT 变换

![](C:\Users\86151\AppData\Roaming\marktext\images\2024-05-05-07-14-16-image.png)

在 DCT 域中的信息隐藏，可以有效地抵抗 JPEG 有损压缩。

二维 DCT 变换：图像分为 8x8 的像素块，进行二维 DCT 变换，得到 8x8 的 DCT 系数。最左上角的系数是直流系数其余是交流系数。左上角部分是直流和低频，右下角部分是高频，中间区域是中频。中低频系数包含了图像的大部分能量，是对人的视觉最重要的部分。

我们可以用一定的方式挑选中频系数，在这些中频系数中叠加秘密信息：

- 所有中频系数
- 固定位置中频系数
- 随机选取中频系数
- 选择最大的几个中频系数

### **1. 算法一**

在选出的中频系数中叠加秘密信息：

```
x'(i,j)=x(i,j)+ami
```

> x(i,j):DCT系数  
> x'(i,j):隐藏后的 DCT 系数  
> mi:第 i 个秘密信息比特  
> a:可调参数，控制嵌入强度  

### **2. 算法二**

在选出的中频系数中叠加秘密信息：

```
x'(i,j)=x(i,j)(1+ami)
```

> 方法一:每个系数上嵌入的强度相同  
> 方法二:根据系数的大小，成比例地嵌入，是对方法一的改进  

- 不足:这两种算法的提取需要原始图像

### **3. 算法三**

无须原始载体的方法：

- 利用载体中两个特定数的相对大小来代表隐藏的信息

### 4. 算法四：

算法三的扩展，利用 DCT 中频系数中的三个特定系数的相对关系来对秘密信息进行编码。

#### (一)嵌入

载体图像分为 `8 × 8` 的块，做二维 DCT 变换，伪随机地选择一个图像块 Bi ，分别选择其中的两个位置，比如用 `(u1,v1)` 和 `(u2,v2)` 代表所选定的两个系数的坐标：

- 如果 `Bi(u1,v1) > Bi(u2,v2)` ，代表隐藏 1 ；反之，则交换两个系数
- 如果 `Bi(u1,v1) < Bi(u2,v2)` ，代表隐藏 0 ；反之，则交换两个系数

#### (二)提取

接收者做二维 DCT 变换，比较每一块中约定位置的 DCT 系数值，并根据其相对大小，得到隐藏信息的比特串，从而恢复出秘密信息

> 特点：不需原始图像。  
> 注意：如果选定位置的两个系数相差太大，则对图像影响较大。应选择相近的值（如中频系数）

### **4. 算法四**

算法三的扩展：

- 利用DCT中频系数中的三个系数之间的相对关系来对秘密信息进行编码

#### (一)嵌入

选择三个位置 (u1,v1) ， (u2,v2) ， (u3,v3) ：

- 嵌入 1：令 Bi(u1,v1) > Bi(u3,v3)+D ， Bi(u2,v2) > Bi(u3,v3)+D
- 嵌入 0：令 Bi(u1,v1) < Bi(u3,v3)-D ， Bi(u2,v2) < Bi(u3,v3)-D
- 如果数据不符，则修改这三个系数值，使得它们满足上述关系

> 其中参数 D 的选择要考虑隐藏的健壮性和不可察觉性之间的平衡，D 越大，隐藏算法对于图像处理就越健壮，但是对图像的改动就越大，越容易引起察觉

- 如果需要做的修改太大，则放弃该块，将其标识为“无效”

> “无效”：对这三个系数做小量的修改使得它们满足下面条件之一：  

`Bi(u1,v1)≤Bi(u3,v3)≤Bi(u2,v2)` 或 `Bi(u1,v1)≥Bi(u3,v3)≥Bi(u2,v2)`

#### (二)提取

对图像进行 DCT 变换，比较每一块相应三个位置的系数，从它们之间的关系，可以判断隐藏的是信息“1”、“0”还是“无效”块，这样就可以恢复秘密信息

#### （三）实验步骤

(1) 将用于当做载体的图片大小设置为 256*256

(2) 将隐藏的图片设置为 64*64，同时将它取反

(3) 然后将图像转换为 double 送入 DCT 算法中进行处理

## 三、代码实现与解释

---

利用 MATLAB 实现了第三个算法，不需要原始载体的信息，用 decode.m 实现秘密信息嵌入，用 encode.m 实现秘密信息提取，字符串处理的函数与上一个实验使用的是一样的，目的是将字符串编码为二进制比特流，或者将二进制比特流解码为字符串

### 1.数据读入

```matlab
clc;clear all;close all;
img = (imread('./raw.bmp'));
watermark = imbinarize(imread('./watermark.bmp'));
img = imresize(img, [256, 256]);
watermark = imresize(~watermark, [64,64]);

img = double(img)/256;
watermark = im2double(watermark);
size = 256; width = 4;

blocks = size / width;
new_image = zeros(size);
vec = ones(64);
```

这段代码的主要目的是准备图像和水印数据，以便进行进一步的处理，例如创建矩阵并将水印添加到图像中。随后是划分块 block 并在而每一个块的某一个特定位置修改 DCT 系数，嵌入秘密信息。嵌入水印，逐块进行扫描。

### **2. encode**

首先是隐藏信息的代码如下：

```matlab
for i = 1 : blocks
    for j = 1 : blocks
        x = (i - 1) * width + 1;
        y = (j - 1) * width + 1;
        cur = img(x:x+width-1, y:y+width-1);
        cur = dct2(cur);

        if watermark(i, j) == 0
            a = -1;
        else
            a = 1;
        end

        cur(1, 1) = cur(1, 1) * (1 + .01 * a) + .01 * a;
        cur = idct2(cur);
        new_image(x: x + width - 1, y : y + width - 1) = cur;
    end
end
```

1. 对需要嵌入的信息做一个预处理，加上一个结尾标记，目的是方便解码时能够正确的提取需要的信息，去除掉冗余信息
2. 彩色图片有 RGB 三层信息，只需要一层来隐藏信息即可，这里取的是第二层来做 DCT 变换隐藏信息
3. 嵌入信息过程中 Alpha 系数用于控制差值大小，将两个系数的差值放大，可以保证提取信息的正确性，但是过大会暴露出载体图片的变化
4. 接下来会做一个对比

### **3. decode**

接下来是提取信息的代码如下：

```matlab
for i = 1 : blocks
    for j = 1 : blocks
        x = (i - 1) * width + 1;
        y = (j - 1) * width + 1;

        if new_image(x, y) > img(x, y)
            vec(i, j) = 1;
        else
            vec(i, j) = 0;
        end
    end
end
```

提取同样是从 RGB 图片的第二层提取，需要做的特殊处理的是将结尾标记之后的信息去掉，就可以得到隐藏信息

### 4. 图像展示：

```matlab
subplot(231); imshow(img);title("原图");
subplot(232); imshow(watermark);title("水印");
subplot(233); imshow(imcomplement(watermark));title("反色之前的水印");
subplot(234); imshow(new_image,[]);title("嵌入");
subplot(235); imshow(vec,[]);title("提取");
subplot(236); imshow(imcomplement(vec),[]);title("与原图对比");
```

## 四、实验结果展示

---

实验中， `Alpha` 系数是可变的，接下来对比一下改变它的效果，用来确定一个合适的值

### **1. Alpha = 0.03**

![](https://i.imgtg.com/2023/04/25/Ip6Ot.png)

### **2. Alpha = 0.1**

![](https://i.imgtg.com/2023/04/25/IpjcX.png)

### **3. Alpha = 0.5**

![](https://i.imgtg.com/2023/04/25/IplTL.png)

### **4. Alpha = 1**

![](https://i.imgtg.com/2023/04/25/Ip9vi.png)

> 从图中可以看出，Alpha = 0.1 时隐约能看到对角线上有痕迹，0.5 和 1 时都较为明显，所以实验中选择了比较小的 0.01 作为差值

***最终结果***

![](C:\Users\86151\AppData\Roaming\marktext\images\2024-05-05-07-47-00-1.png)

可以看出信息能够完美提取出来

## 五、总结与展望

---

在这个实验中，我们学习了一种图像水印技术——变换域隐藏法。这种技术可以将水印信息嵌入到图像的 DCT 变换系数中，从而实现对图像的保护和认证。在实验中，我们使用 MATLAB语言编写了相关的代码，并对图像进行了嵌入水印和提取水印的操作。通过这个实验，我深刻地认识到了图像水印技术的重要性和应用价值。

通过这个实验，我不仅学习了图像水印技术的基本原理和实现方法，还学习了如何使用 MATLAB 语言进行图像处理和编程。这对于我今后的学习和工作都具有非常重要的意义。通过这个实验，我深刻地认识到了图像水印技术的重要性和应用价值，也更加熟练地掌握了MATLAB 语言的使用方法。我相信这些知识和技能对于我的未来发展和职业规划都将产生积极的影响。

期待自己未来更好的发展，能够在信息隐藏技术这门课程的学习上学习到更多有用的知识，继续努力更上一层楼。
